- name: Get Vivado Base Directory
  set_fact:
    base_dir: "{{ exec_bin | dirname }}"
    exec_bin: "{{ exec_bin | basename }}"

- debug:
    msg: "Program Device Result: {{ base_dir }} | {{ exec_bin }}"

- name: Copy script files to target
  copy:
    src: "{{ item.src }}"
    dest: "{{ item.dest }}"
  with_items:
    - { src: '{{ program_tcl }}', dest: '/tmp/{{ program_tcl }}'}

- name: Program Device
  register: result
  shell:
    chdir: "{{ base_dir }}"
    cmd: "{{ exec_bin }} -mode tcl -source {{ program_tcl }}"
    warn: false

- debug:
    msg: "Program Device Result: {{ result }}"